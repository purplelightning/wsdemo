<html>
  <head>
    <title>call,bind,apply,new</title>
  </head>
  <body>

  </body>
  <script>
    // new
    function New(fn, ...args){
      let obj = Object.create(fn.prototype)
      let res = fn.call(obj, ...args)
      if(res && (typeof res === 'object' || typeof res === 'function')){
        return res
      }
      return obj
    }

    // function Person(name, age) {
    //   this.name = name;
    //   this.age = age;
    // }
    // Person.prototype.say = function() {
    //   console.log(this.age);
    // };
    // let p1 = New(Person, "lihua", 18);
    // console.log(p1.name);
    // console.log(p1);
    // p1.say();


    // call
    Function.prototype.myCall = function(context = window){
      //this为调用myCall方法的函数，相当于给context增加方法，这个方法的this指向context，达到改变this的目的
      context.fn = this
      let args = [...arguments].slice(1)
      let res = context.fn(...args)
      delete context.fn
      return res
    }
    let foo = {
      value: 1
    }
    // function bar(name, age) {
    //   console.log(name)
    //   console.log(age)
    //   console.log(this.value);
    // }
    // bar.myCall(foo, 'black', '18') // black 18 1


    Function.prototype.myApply = function(context = window){
      context.fn = this
      let args = [...arguments][1]
      let res = context.fn(args)
      delete context.fn
      return res
    }

    function bar1(arr) {
      console.log(arr[0])
      console.log(arr[1])
      console.log(arr[2])
      console.log(this.value);
    }
    bar1.myApply(foo, ['aaa','bbb','ccdc'])

  </script>
</html>